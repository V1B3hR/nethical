---
# NIST 800-53 Audit Policy Configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: nethical-nist-audit-policy
  namespace: nethical
  labels:
    app.kubernetes.io/name: nethical
    compliance.nethical.io/framework: nist-800-53
data:
  audit-policy.yaml: |
    version: "1.0"
    compliance_framework: "NIST_800_53"
    
    # AU-2: Audit Events
    # The information system generates audit records for the following events
    auditable_events:
      # Authentication events
      authentication:
        - successful_authentication
        - failed_authentication
        - account_lockout
        - account_unlock
        - mfa_success
        - mfa_failure
        
      # Authorization events
      authorization:
        - access_granted
        - access_denied
        - privilege_escalation
        - role_assignment
        - role_removal
        
      # Data access events
      data_access:
        - data_read
        - data_create
        - data_update
        - data_delete
        - data_export
        - bulk_operation
        
      # Administrative events
      administrative:
        - configuration_change
        - policy_change
        - user_management
        - security_setting_change
        - system_startup
        - system_shutdown
        
      # Security events
      security:
        - intrusion_detected
        - malware_detected
        - anomaly_detected
        - threshold_exceeded
        
    # AU-3: Content of Audit Records
    audit_record_content:
      required_fields:
        - timestamp_utc
        - event_type
        - user_identity
        - source_ip_address
        - outcome_status
        - resource_identifier
      optional_fields:
        - session_id
        - request_id
        - correlation_id
        - user_agent
        - geo_location
        
    # AU-6: Audit Review, Analysis, and Reporting
    audit_review:
      automated_review: true
      review_frequency: "continuous"
      correlation_rules: true
      anomaly_detection: true
      reporting:
        - type: "security_summary"
          frequency: "daily"
        - type: "compliance_report"
          frequency: "weekly"
        - type: "incident_report"
          frequency: "on_demand"
          
    # AU-9: Protection of Audit Information
    audit_protection:
      immutable: true
      encrypted: true
      integrity_verification: "merkle_tree"
      access_control: "restricted"
      backup_required: true
      
    # AU-11: Audit Record Retention
    audit_retention:
      retention_period_years: 7
      archival_strategy: "tiered"
      deletion_policy: "secure_erase"
