# Nethical Tight-Budget Configuration
# 
# This configuration provides a starting point for deployments targeting
# ~100 RPS with headroom for very good performance.
#
# Usage:
#   With docker-compose:
#     docker-compose --env-file examples/perf/tight_budget_config.env up
#   
#   Direct export:
#     export $(cat examples/perf/tight_budget_config.env | grep -v '^#' | xargs)
#     python your_app.py

# ============================================================================
# CORE GOVERNANCE SETTINGS
# ============================================================================

# Storage location for governance data
NETHICAL_STORAGE_DIR=/data/nethical

# Regional/domain identifiers for sharding and federated analytics
NETHICAL_REGION_ID=us-east-1
NETHICAL_LOGICAL_DOMAIN=default

# ============================================================================
# QUOTA & BACKPRESSURE (Core Tier - Always On)
# ============================================================================

# Enable quota enforcement to protect against bursts and DoS
NETHICAL_ENABLE_QUOTA=true

# Global RPS ceiling (adjust based on hardware and target capacity)
# Recommended starting values:
#   - Tight budget (2-4 vCPU, 8-16GB RAM): 100 RPS
#   - Medium (4-8 vCPU, 16-32GB RAM): 300 RPS
#   - Production (8+ vCPU, 32GB+ RAM): 500-1000 RPS
NETHICAL_REQUESTS_PER_SECOND=100.0

# Maximum payload size (bytes) to prevent resource exhaustion
NETHICAL_MAX_PAYLOAD_BYTES=1000000

# ============================================================================
# OBSERVABILITY (Core Tier - Always On)
# ============================================================================

# Enable OpenTelemetry for metrics, traces, and logs
# Essential for monitoring p50/p95/p99 latency and throughput
NETHICAL_ENABLE_OTEL=true

# OTEL exporter configuration
OTEL_EXPORTER=otlp
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_SERVICE_NAME=nethical

# ============================================================================
# PRIVACY & REDACTION (Core Tier)
# ============================================================================

# Privacy mode: none (disabled), standard (basic PII), differential (DP+PII)
# Options:
#   - none: No privacy features (not recommended for production)
#   - standard: Basic PII detection and redaction (~5-10ms overhead)
#   - differential: DP aggregation + PII redaction (~15-25ms overhead)
NETHICAL_PRIVACY_MODE=standard

# Differential privacy epsilon (lower = more privacy, higher = more utility)
# Only applies when NETHICAL_PRIVACY_MODE=differential
# Recommended: 1.0 (balanced), 0.1 (high privacy), 10.0 (low privacy)
NETHICAL_EPSILON=1.0

# PII redaction policy: minimal, standard, aggressive
# Options:
#   - minimal: Only redact high-risk PII (SSN, credit cards) - fast
#   - standard: Redact common PII (email, phone, SSN, CC) - balanced
#   - aggressive: Deep PII scanning with context analysis - slower
NETHICAL_REDACTION_POLICY=standard

# ============================================================================
# AUDIT & INTEGRITY (Medium Tier - Recommended)
# ============================================================================

# Enable Merkle anchoring for tamper-evident audit logs
# Adds ~10-20ms overhead but provides immutable audit trail
# Batches events for efficiency (default: 100 events or 5 seconds)
NETHICAL_ENABLE_MERKLE=true

# Enable quarantine mode (isolate suspicious actions)
# Set to 'false' initially; enable when mature detection is in place
NETHICAL_ENABLE_QUARANTINE=false

# Enable ethical taxonomy tagging (categorize violations)
# Useful for analytics and reporting; minimal overhead
NETHICAL_ENABLE_ETHICAL_TAXONOMY=true

# Enable SLA monitoring (track triage and resolution times)
# Useful for human-in-the-loop workflows
NETHICAL_ENABLE_SLA_MONITORING=true

# ============================================================================
# ML & ANOMALY DETECTION (Heavy Tier - Shadow Mode Initially)
# ============================================================================

# Enable ML shadow mode (log ML scores without enforcement)
# Recommended: Start in shadow mode to collect baselines
# Graduate to blended enforcement after 1-2 weeks of data
NETHICAL_ENABLE_SHADOW_MODE=true

# Enable ML blended enforcement (hybrid rule+ML decisions)
# Only use in gray zone (0.4-0.6 rule risk) to reduce overhead
# Set to 'false' initially; enable after shadow mode validation
NETHICAL_ENABLE_ML_BLENDING=false

# Enable anomaly detection (sequence, behavioral, drift)
# Start with alerting only; enforce after establishing baselines
# Adds ~30-50ms overhead depending on window size
NETHICAL_ENABLE_ANOMALY_DETECTION=false

# ============================================================================
# TUNING PARAMETERS
# ============================================================================

# Risk engine parameters
# NETHICAL_RISK_DECAY_RATE=0.95  # How fast old violations are forgotten
# NETHICAL_RISK_HIGH_THRESHOLD=0.7  # Threshold for high-risk classification

# ML blending weights (rule_weight + ml_weight = 1.0)
# NETHICAL_RULE_WEIGHT=0.7  # Weight for rule-based risk
# NETHICAL_ML_WEIGHT=0.3    # Weight for ML risk

# Anomaly detection thresholds
# NETHICAL_ANOMALY_SEQUENCE_THRESHOLD=0.7  # Sequence anomaly threshold
# NETHICAL_ANOMALY_DRIFT_THRESHOLD=0.3     # Drift severity threshold
# NETHICAL_PSI_THRESHOLD=0.2               # PSI drift threshold

# Human-in-the-loop escalation
# NETHICAL_AUTO_ESCALATE_ON_BLOCK=false       # Auto-escalate BLOCK decisions
# NETHICAL_AUTO_ESCALATE_ON_LOW_CONFIDENCE=false  # Auto-escalate low confidence

# ============================================================================
# GROWTH PATH NOTES
# ============================================================================
#
# As your deployment scales or budget allows, adjust in stages:
#
# Stage 1: Vertical Scaling (100 → 300 RPS)
#   - Increase NETHICAL_REQUESTS_PER_SECOND to 300
#   - Set NETHICAL_ENABLE_QUARANTINE=true
#   - Enable Redis for caching (add redis_url)
#
# Stage 2: Feature Graduation (300 → 500 RPS)
#   - Set NETHICAL_ENABLE_ML_BLENDING=true (after shadow validation)
#   - Set NETHICAL_ENABLE_ANOMALY_DETECTION=true
#   - Consider NETHICAL_REDACTION_POLICY=aggressive if needed
#
# Stage 3: Horizontal Scaling (500+ RPS)
#   - Deploy multiple instances with load balancer
#   - Shard by NETHICAL_REGION_ID or NETHICAL_LOGICAL_DOMAIN
#   - Use shared Redis cluster for quota state
#   - Centralize observability (Prometheus/Grafana)
#
# See docs/ops/PERFORMANCE_SIZING.md for detailed guidance.
